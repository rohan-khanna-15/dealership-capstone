{% extends "djangoapp/base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        {% if dealer %}
            <h2>Add Review for {{ dealer.full_name }}</h2>
            
            <div class="card">
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        
                        <div class="mb-3">
                            <label for="content" class="form-label">Your Review *</label>
                            <textarea class="form-control" id="content" name="content" rows="4" 
                                      placeholder="Share your experience with this dealership..." required></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="purchasecheck" name="purchasecheck">
                                <label class="form-check-label" for="purchasecheck">
                                    I purchased a car from this dealership
                                </label>
                            </div>
                        </div>
                        
                        <div id="purchase-details" style="display: none;">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="car" class="form-label">Car Model</label>
                                        <select class="form-select" id="car" name="car">
                                            <option value="">Select a car model</option>
                                            {% for car in cars %}
                                                <option value="{{ car.id }}">{{ car.car_make.name }} {{ car.name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="car_year" class="form-label">Year</label>
                                        <select class="form-select" id="car_year" name="car_year">
                                            <option value="">Select year</option>
                                            <option value="2024">2024</option>
                                            <option value="2023">2023</option>
                                            <option value="2022">2022</option>
                                            <option value="2021">2021</option>
                                            <option value="2020">2020</option>
                                            <option value="2019">2019</option>
                                            <option value="2018">2018</option>
                                            <option value="2017">2017</option>
                                            <option value="2016">2016</option>
                                            <option value="2015">2015</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="purchasedate" class="form-label">Purchase Date</label>
                                <input type="date" class="form-control" id="purchasedate" name="purchasedate">
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="{% url 'djangoapp:get_dealers' %}" class="btn btn-secondary me-md-2">Back to Dealers</a>
                            <button type="submit" class="btn btn-primary">Submit Review</button>
                        </div>
                    </form>
                </div>
            </div>
        {% else %}
            <div class="alert alert-danger">
                <h4>Error</h4>
                <p>Dealer not found. Please go back and select a valid dealer.</p>
                <a href="{% url 'djangoapp:get_dealers' %}" class="btn btn-primary">Back to Dealers</a>
            </div>
        {% endif %}
    </div>
</div>

<script>
    document.getElementById('purchasecheck').addEventListener('change', function() {
        const purchaseDetails = document.getElementById('purchase-details');
        if (this.checked) {
            purchaseDetails.style.display = 'block';
        } else {
            purchaseDetails.style.display = 'none';
        }
    });
</script>
{% endblock %}
